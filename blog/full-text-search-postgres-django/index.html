<!doctype html>
<html lang="pt-br" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Full-Text Search: Implementando com Postgres e Django | Eduardo Oliveira</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://eduardojm.github.io/blog/full-text-search-postgres-django"><meta data-rh="true" property="og:locale" content="pt_br"><meta data-rh="true" name="docusaurus_locale" content="pt-br"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="pt-br"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Full-Text Search: Implementando com Postgres e Django | Eduardo Oliveira"><meta data-rh="true" name="description" content="This is my first post on Docusaurus."><meta data-rh="true" property="og:description" content="This is my first post on Docusaurus."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-04-10T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/EduardoJM"><meta data-rh="true" property="article:tag" content="Django,PostgreSQL,Full-Text Search"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://eduardojm.github.io/blog/full-text-search-postgres-django"><link data-rh="true" rel="alternate" href="https://eduardojm.github.io/blog/full-text-search-postgres-django" hreflang="pt-br"><link data-rh="true" rel="alternate" href="https://eduardojm.github.io/blog/full-text-search-postgres-django" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://eduardojm.github.io/blog/full-text-search-postgres-django","mainEntityOfPage":"https://eduardojm.github.io/blog/full-text-search-postgres-django","url":"https://eduardojm.github.io/blog/full-text-search-postgres-django","headline":"Full-Text Search: Implementando com Postgres e Django","name":"Full-Text Search: Implementando com Postgres e Django","description":"This is my first post on Docusaurus.","datePublished":"2023-04-10T00:00:00.000Z","author":{"@type":"Person","name":"Eduardo Oliveira","description":"Co-creator of Docusaurus 1","url":"https://github.com/EduardoJM","email":"eduardo_y05@outlook.com","image":"https://github.com/EduardoJM.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://eduardojm.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Eduardo Oliveira RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Eduardo Oliveira Atom Feed">






<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.ef27732e.css">
<script src="/assets/js/runtime~main.e9661ec5.js" defer="defer"></script>
<script src="/assets/js/main.b6df0f4e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Pular para o conteúdo principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Pular para o conteúdo principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Alternar a barra de navegação" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/">Início</a><a class="navbar__item navbar__link" href="/docs/intro">Anotações</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Artigos</a><a href="http://dev.to/eduardojm" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><button class="btn-cv">Download CV</button></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Artigos recentes</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/htmx-por-que-eu-uso">HTMX: por que eu uso?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/django-htmx-react-alem-de-todo-lists">Django, Htmx e React: usando HTMX para além de TODO-Lists</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/full-text-search-drf-postgres-django">Full-Text Search: Criando um Back-End de Filtro para o Django Rest-Framework</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/full-text-search-postgres-django">Full-Text Search: Implementando com Postgres e Django</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Full-Text Search: Implementando com Postgres e Django</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-04-10T00:00:00.000Z">10 de abril de 2023</time> · <!-- -->Leitura de 6 minutos</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/EduardoJM" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/EduardoJM.png" alt="Eduardo Oliveira"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/EduardoJM" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Eduardo Oliveira</span></a></div><small class="authorTitle_nd0D" title="Co-creator of Docusaurus 1">Co-creator of Docusaurus 1</small><div class="authorSocials_rSDt"><a href="https://github.com/EduardoJM" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a><a href="https://bsky.app/profile/goticodocalypso.dev" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="Bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid" viewBox="0 0 256 226" class="authorSocialLink_owbf"><path fill="#1185FE" d="M55.491 15.172c29.35 22.035 60.917 66.712 72.509 90.686 11.592-23.974 43.159-68.651 72.509-90.686C221.686-.727 256-13.028 256 26.116c0 7.818-4.482 65.674-7.111 75.068-9.138 32.654-42.436 40.983-72.057 35.942 51.775 8.812 64.946 38 36.501 67.187-54.021 55.433-77.644-13.908-83.696-31.676-1.11-3.257-1.63-4.78-1.637-3.485-.008-1.296-.527.228-1.637 3.485-6.052 17.768-29.675 87.11-83.696 31.676-28.445-29.187-15.274-58.375 36.5-67.187-29.62 5.041-62.918-3.288-72.056-35.942C4.482 91.79 0 33.934 0 26.116 0-13.028 34.314-.727 55.491 15.172Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Algum tempo atrás vi o texto &quot;A powerful full-text search in PostgreSQL in less than 20 lines&quot; do Leandro Proença [1] e quis implementar algo assim pra projetos que não demandam o poder de um Apache Lucene ou de um Elastic Search.</p>
<p>O django já possui, em seu <em>core</em>, uma aplicação com métodos que são utilizados apenas com o <strong>Postgres</strong> e, para a minha surpresa, todos os conceitos de <em>full-text search</em> já estavam disponíveis nesse <em>app</em>.</p>
<p>Restou, nesse caso, tentar reproduzir, por assim dizer, a <em>query</em> do texto original utilizando o <strong>ORM</strong> do django e os métodos do <em>full-text search</em>.</p>
<p>Esse texto tem, por objetivo, trazer explicações sobre como essa implementação foi feita. Fundamentalmente, esse texto será uma versão explicada <a href="https://twitter.com/goticodocalypso/status/1645248408066613248" target="_blank" rel="noopener noreferrer">dessa thread no twitter</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mostre-me-o-código">Mostre-me o código<a href="#mostre-me-o-código" class="hash-link" aria-label="Link direto para Mostre-me o código" title="Link direto para Mostre-me o código">​</a></h2>
<p>Todo o código-fonte do projeto está disponível no GitHub, <a href="https://github.com/EduardoJM/django-full-text-search" target="_blank" rel="noopener noreferrer">nesse repositório</a>.</p>
<blockquote>
<p>Disclaimer:</p>
<p>O código da versão desse texto está disponível na branch <a href="https://github.com/EduardoJM/django-full-text-search/tree/texto-1" target="_blank" rel="noopener noreferrer">texto-1</a>.</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="adicionando-configurações-necessárias">Adicionando configurações necessárias<a href="#adicionando-configurações-necessárias" class="hash-link" aria-label="Link direto para Adicionando configurações necessárias" title="Link direto para Adicionando configurações necessárias">​</a></h2>
<p>Dentro do <code>settings.py</code> do projeto, precisamos adicionar a aplicação <code>django.contrib.postgres</code> dentro da variável de <code>INSTALLED_APPS</code> para que possamos utilizar as ferramentas do <strong>django</strong> próprias para o <strong>Postgres</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INSTALLED_APPS </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;django.contrib.admin&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;django.contrib.auth&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;django.contrib.contenttypes&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;django.contrib.sessions&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;django.contrib.messages&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;django.contrib.staticfiles&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;django.contrib.postgres&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="criando-o-model">Criando o model<a href="#criando-o-model" class="hash-link" aria-label="Link direto para Criando o model" title="Link direto para Criando o model">​</a></h2>
<p>Precisamos criar um <em>model</em> para poder utilizar os conceitos da busca dentro dele. Para simplificar, esse caso, utilizamos um <em>model</em> com um único campo de texto para as buscas:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">models</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    name </span><span class="token operator">=</span><span class="token plain"> models</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">CharField</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cantor&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> max_length</span><span class="token operator">=</span><span class="token number">150</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">__str__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">Meta</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        verbose_name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cantor&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        verbose_name_plural </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cantores&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="criando-uma-view">Criando uma view<a href="#criando-uma-view" class="hash-link" aria-label="Link direto para Criando uma view" title="Link direto para Criando uma view">​</a></h2>
<p>Para testar os conceitos de <em>full-text search</em>, podemos criar uma <em>view</em>. Antes, é necessário dizer que nesse texto estou usando <em>views</em> padrão do <strong>django</strong> com <em>templates</em> em HTML para não adicionar mais complexidade lidando com o <em>Rest Framework</em>.</p>
<p>Podemos criar uma <em>view</em> que recebe uma <em>query string</em> para fazer a busca:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shortcuts </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> render</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Singer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">search_singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    term </span><span class="token operator">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;q&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># TODO: fazer busca aqui</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        singers </span><span class="token operator">=</span><span class="token plain"> Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">order_by</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">all</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    context </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;singers&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> singers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;term&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> render</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;cantor.html&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>O <em>template</em> <code>cantor.html</code> que estou utilizando é bem simples apenas para permitir testes de forma mais fácil:</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token doctype punctuation" style="color:rgb(248, 248, 242)">&lt;!</span><span class="token doctype doctype-tag">DOCTYPE</span><span class="token doctype"> </span><span class="token doctype name">html</span><span class="token doctype punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">html</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">lang</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">en</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">head</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">meta</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">charset</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">UTF-8</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">meta</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">http-equiv</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">X-UA-Compatible</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">content</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">IE=edge</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">meta</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">viewport</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">content</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">width=device-width, initial-scale=1.0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">title</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Buscando Cantores</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">title</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">head</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">body</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">form</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">action</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">input</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">q</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">{%</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">if</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">term</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">%}</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">value</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">{{ term }}</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">{%</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">endif</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">%}</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">button</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">submit</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Pesquisar</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">button</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">form</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {% if singers %}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">main</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      {% for item in singers %}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">h3</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">{{item.name}}</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">h3</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {% if item.rank or item.similarity %}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Rank: {{item.rank}}, Similaridade: {{item.similarity}}</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {% endif %}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      {% endfor %}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">main</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {% endif %}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">body</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">html</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="full-text-search">Full-Text Search<a href="#full-text-search" class="hash-link" aria-label="Link direto para Full-Text Search" title="Link direto para Full-Text Search">​</a></h2>
<p>Precisamos, primeiro, criar um <strong>SearchVector</strong> (<em>ts_vector</em>) e um <strong>SearchQuery</strong> (<em>tsquery</em>). Assim:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">search </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SearchQuery</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vector </span><span class="token operator">=</span><span class="token plain"> SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;portuguese&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">query </span><span class="token operator">=</span><span class="token plain"> SearchQuery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;portuguese&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>O vector é feito assim pra utilizar a coluna &quot;name&quot; do model <strong>Singer</strong>. A query é feita para processar a variável <em>term</em> recebida no código da <em>view</em> acima.</p>
<p>O próximo ponto é criar <em>annotations</em> para fazer o <em>select</em> de campos como o <em>to_tsvector</em> e o <em>ts_rank</em> (o método <code>.annotate</code> do <em>Django ORM</em> faz o <em>select</em> de outros campos e agrega eles a entidade):</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">search </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SearchQuery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SearchRank</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vector </span><span class="token operator">=</span><span class="token plain"> SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;portuguese&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">query </span><span class="token operator">=</span><span class="token plain"> SearchQuery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;portuguese&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">singers </span><span class="token operator">=</span><span class="token plain"> Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">annotate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    search</span><span class="token operator">=</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rank</span><span class="token operator">=</span><span class="token plain">SearchRank</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">filter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    search</span><span class="token operator">=</span><span class="token plain">query</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">order_by</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-rank&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">all</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Adicionando o código dentro da view, passamos a ter:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shortcuts </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> render</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">search </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SearchQuery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SearchRank</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Singer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">search_singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    term </span><span class="token operator">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;q&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        vector </span><span class="token operator">=</span><span class="token plain"> SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;portuguese&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        query </span><span class="token operator">=</span><span class="token plain"> SearchQuery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;portuguese&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        singers </span><span class="token operator">=</span><span class="token plain"> Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">annotate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            search</span><span class="token operator">=</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            rank</span><span class="token operator">=</span><span class="token plain">SearchRank</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">filter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            search</span><span class="token operator">=</span><span class="token plain">query</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">order_by</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-rank&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">all</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        singers </span><span class="token operator">=</span><span class="token plain"> Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">order_by</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">all</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    context </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;singers&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> singers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;term&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> render</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;cantor.html&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Utilizando um pequeno grupo de dados para teste:</p>
<p><img decoding="async" loading="lazy" alt="Dados sem Busca" src="data:image/png;base64,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" width="394" height="528" class="img_ev3q"></p>
<p>Podeos testar e verificar que passamos a ter uma busca funcional:</p>
<p><img decoding="async" loading="lazy" alt="Resultado de Busca" src="data:image/png;base64,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" width="368" height="295" class="img_ev3q"></p>
<p>Porém, ainda temos alguns problemas, pois, por exemplo, na busca por palavras incompletas, perdemos o ranqueamento:</p>
<p><img decoding="async" loading="lazy" alt="Busca incompleta" src="data:image/png;base64,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" width="377" height="133" class="img_ev3q"></p>
<p>Nesse ponto, entra a busca por similaridade que, combinada com o <em>Full-Text Search</em> nos permitirá fazer uma busca mais funcional.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="busca-por-similaridade">Busca por Similaridade<a href="#busca-por-similaridade" class="hash-link" aria-label="Link direto para Busca por Similaridade" title="Link direto para Busca por Similaridade">​</a></h2>
<p>Precisamos, primeiro, adicionar a extensão <strong>pg_trgm</strong> no banco de dados. Podemos fazer isso manualmente ou podemos criar uma <em>migration</em> vazia e adicionar essa extensão na <em>migration</em>. Vou seguir pela segunda opção. Para a primeira, basta executar o comando no banco de dados:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> EXTENSION pg_trgm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Para a segunda abordagem, podemos executar o comando <code>python manage.py makemigrations nome_do_app --empty</code> e ele criará uma -<em>migration</em> vazia. A partir da <em>migration</em> vazia, podemos adicionar o import ao CreateExtension e adicionar dentro de operations:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">db </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> migrations</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">operations </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> CreateExtension</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">Migration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">migrations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Migration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    dependencies </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;texto&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0003_alter_feat_music&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    operations </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        CreateExtension</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pg_trgm&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Basta agora executar <code>python manage.py migrate</code> e teremos a extensão criada no banco de dados.</p>
<p>Agora, dentro da nossa busca, podemos fazer o uso do <strong>TrigramSimilarity</strong> para melhorar nossos resultados. Primeiro, vamos adicionar dentro do <code>.annotate</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">search </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SearchQuery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SearchRank</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> TrigramSimilarity</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">singers </span><span class="token operator">=</span><span class="token plain"> Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">annotate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    search</span><span class="token operator">=</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rank</span><span class="token operator">=</span><span class="token plain">SearchRank</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    similarity</span><span class="token operator">=</span><span class="token plain">TrigramSimilarity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Precisamos, também, alterar o <code>.filter</code> para utilizar de um operador lógico <strong>OU</strong>. Para isso, precisamos fazer uso do <code>Q(condição 1) | Q(condição 2)</code> do <strong>django</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">search </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SearchQuery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SearchRank</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> TrigramSimilarity</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Q</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">singers </span><span class="token operator">=</span><span class="token plain"> Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">annotate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    search</span><span class="token operator">=</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rank</span><span class="token operator">=</span><span class="token plain">SearchRank</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    similarity</span><span class="token operator">=</span><span class="token plain">TrigramSimilarity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">filter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Q</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">search</span><span class="token operator">=</span><span class="token plain">query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> Q</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">similarity__gt</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">order_by</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-rank&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-similarity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">all</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Aqui, o que fazemos é adicionar o campo de <em>similarity</em> na nossa <em>query</em> e filtrar pra &quot;o full-text search encontrou&quot; ou &quot;a similaridade é maior que zero&quot;. A partir desse momento, fazendo a mesma busca de um dos prints acima:</p>
<p><img decoding="async" loading="lazy" alt="Busca por Similaridade" src="/assets/images/full_text_4-f721a399e58b0235f1f012d33b90e6fe.png" width="331" height="285" class="img_ev3q"></p>
<p>Por fim, nossa <em>view</em> passa a ter o código:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shortcuts </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> render</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Q</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">search </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    SearchQuery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    SearchRank</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    TrigramSimilarity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Singer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">search_singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    term </span><span class="token operator">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">GET</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;q&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        vector </span><span class="token operator">=</span><span class="token plain"> SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;portuguese&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        query </span><span class="token operator">=</span><span class="token plain"> SearchQuery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;portuguese&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        singers </span><span class="token operator">=</span><span class="token plain"> Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">annotate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            search</span><span class="token operator">=</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            rank</span><span class="token operator">=</span><span class="token plain">SearchRank</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">vector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            similarity</span><span class="token operator">=</span><span class="token plain">TrigramSimilarity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">filter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Q</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">search</span><span class="token operator">=</span><span class="token plain">query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> Q</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">similarity__gt</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">order_by</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-rank&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-similarity&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">all</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        singers </span><span class="token operator">=</span><span class="token plain"> Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">order_by</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">all</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    context </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;singers&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> singers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;term&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> term</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> render</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;cantor.html&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>É possível utilizar tanto o <em>rank</em> ou o <em>similarity</em> para cortar valores, conforme exemplos da documentação.</p>
<p>Por último, podemos adicionar um índice dentro do nosso <em>model</em> para lidar com performance das queries:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">db </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> models</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">indexes </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> GinIndex</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">search </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> SearchVector</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">Singer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">models</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    name </span><span class="token operator">=</span><span class="token plain"> models</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">CharField</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cantor&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> max_length</span><span class="token operator">=</span><span class="token number">150</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">__str__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">Meta</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        verbose_name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cantor&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        verbose_name_plural </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cantores&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        indexes </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            GinIndex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                SearchVector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;portuguese&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;singer_search_vector_idx&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código para a área de transferência" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<p>Todo o código-fonte do projeto está disponível no GitHub, <a href="https://github.com/EduardoJM/django-full-text-search" target="_blank" rel="noopener noreferrer">nesse repositório</a>.</p>
<blockquote>
<p>Disclaimer:</p>
<p>O código da versão desse texto está disponível na branch <a href="https://github.com/EduardoJM/django-full-text-search/tree/texto-1" target="_blank" rel="noopener noreferrer">texto-1</a>.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="referências">Referências<a href="#referências" class="hash-link" aria-label="Link direto para Referências" title="Link direto para Referências">​</a></h2>
<p>1 - <a href="https://leandronsp.com/a-powerful-full-text-search-in-postgresql-in-less-than-20-lines" target="_blank" rel="noopener noreferrer">A powerful full-text search in PostgreSQL in less than 20 lines
</a></p>
<p>2 - <a href="https://docs.djangoproject.com/en/4.2/ref/contrib/postgres/search/" target="_blank" rel="noopener noreferrer">Full text search - Django Documentation</a></p>
<hr>
<p><a href="https://unsplash.com/pt-br/fotografias/eQ2Z9ay9Wws" target="_blank" rel="noopener noreferrer">Foto de capa por Mick Haupt no Unsplash</a>.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Marcadores:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/django">Django</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/postgre-sql">PostgreSQL</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/full-text-search">Full-Text Search</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Navegação da página de postagem do blog"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/full-text-search-drf-postgres-django"><div class="pagination-nav__sublabel">Postagem mais nova</div><div class="pagination-nav__label">Full-Text Search: Criando um Back-End de Filtro para o Django Rest-Framework</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#mostre-me-o-código" class="table-of-contents__link toc-highlight">Mostre-me o código</a></li><li><a href="#adicionando-configurações-necessárias" class="table-of-contents__link toc-highlight">Adicionando configurações necessárias</a></li><li><a href="#criando-o-model" class="table-of-contents__link toc-highlight">Criando o model</a></li><li><a href="#criando-uma-view" class="table-of-contents__link toc-highlight">Criando uma view</a></li><li><a href="#full-text-search" class="table-of-contents__link toc-highlight">Full-Text Search</a></li><li><a href="#busca-por-similaridade" class="table-of-contents__link toc-highlight">Busca por Similaridade</a></li><li><a href="#referências" class="table-of-contents__link toc-highlight">Referências</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Internet</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Anotações</a></li></ul></div><div class="col footer__col"><div class="footer__title">Autor</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/EduardoJM" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/goticodocalypso" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/edujso/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Mais</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.polywork.com/eduardo_oliveira" target="_blank" rel="noopener noreferrer" class="footer__link-item">Polywork<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://dev.to/eduardojm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dev.to<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Eduardo Oliveira. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>